<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">

<title>README_FOR_APP - Prestissimo Documentation</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body class="file">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../doc/README_FOR_APP.html">README_FOR_APP</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../JqueryWeekCalendar.html">JqueryWeekCalendar</a>
  
    <li><a href="../JqueryWeekCalendar/Install.html">JqueryWeekCalendar::Install</a>
  
    <li><a href="../JqueryWeekCalendar/Rails.html">JqueryWeekCalendar::Rails</a>
  
    <li><a href="../JqueryWeekCalendar/Rails/Engine.html">JqueryWeekCalendar::Rails::Engine</a>
  
    <li><a href="../JqueryWeekCalendar/Rails/Railtie.html">JqueryWeekCalendar::Rails::Railtie</a>
  
    <li><a href="../AdminsController.html">AdminsController</a>
  
    <li><a href="../AdminsHelper.html">AdminsHelper</a>
  
    <li><a href="../ApplicationController.html">ApplicationController</a>
  
    <li><a href="../ApplicationHelper.html">ApplicationHelper</a>
  
    <li><a href="../Cart.html">Cart</a>
  
    <li><a href="../CartsController.html">CartsController</a>
  
    <li><a href="../CartsHelper.html">CartsHelper</a>
  
    <li><a href="../Comment.html">Comment</a>
  
    <li><a href="../CommentsController.html">CommentsController</a>
  
    <li><a href="../CommentsHelper.html">CommentsHelper</a>
  
    <li><a href="../Course.html">Course</a>
  
    <li><a href="../CoursesController.html">CoursesController</a>
  
    <li><a href="../CoursesHelper.html">CoursesHelper</a>
  
    <li><a href="../Department.html">Department</a>
  
    <li><a href="../DepartmentsController.html">DepartmentsController</a>
  
    <li><a href="../DepartmentsHelper.html">DepartmentsHelper</a>
  
    <li><a href="../ErrorsController.html">ErrorsController</a>
  
    <li><a href="../Handle.html">Handle</a>
  
    <li><a href="../HandlesController.html">HandlesController</a>
  
    <li><a href="../HandlesHelper.html">HandlesHelper</a>
  
    <li><a href="../Hubcourse.html">Hubcourse</a>
  
    <li><a href="../HubcoursesController.html">HubcoursesController</a>
  
    <li><a href="../HubcoursesHelper.html">HubcoursesHelper</a>
  
    <li><a href="../Interact.html">Interact</a>
  
    <li><a href="../MajorsHelper.html">MajorsHelper</a>
  
    <li><a href="../MyClassesController.html">MyClassesController</a>
  
    <li><a href="../MyClassesHelper.html">MyClassesHelper</a>
  
    <li><a href="../Professor.html">Professor</a>
  
    <li><a href="../ProfessorsController.html">ProfessorsController</a>
  
    <li><a href="../ProfessorsHelper.html">ProfessorsHelper</a>
  
    <li><a href="../Report.html">Report</a>
  
    <li><a href="../ReportsController.html">ReportsController</a>
  
    <li><a href="../ReportsHelper.html">ReportsHelper</a>
  
    <li><a href="../SessionsController.html">SessionsController</a>
  
    <li><a href="../SessionsHelper.html">SessionsHelper</a>
  
    <li><a href="../Setting.html">Setting</a>
  
    <li><a href="../SettingsController.html">SettingsController</a>
  
    <li><a href="../SettingsHelper.html">SettingsHelper</a>
  
    <li><a href="../StaticPagesController.html">StaticPagesController</a>
  
    <li><a href="../StaticPagesHelper.html">StaticPagesHelper</a>
  
    <li><a href="../Syllabus.html">Syllabus</a>
  
    <li><a href="../SyllabusController.html">SyllabusController</a>
  
    <li><a href="../SyllabusHelper.html">SyllabusHelper</a>
  
    <li><a href="../UTF8Sanitizer.html">UTF8Sanitizer</a>
  
    <li><a href="../User.html">User</a>
  
    <li><a href="../UsersController.html">UsersController</a>
  
    <li><a href="../UsersHelper.html">UsersHelper</a>
  
    <li><a href="../VotesController.html">VotesController</a>
  
    <li><a href="../VotesHelper.html">VotesHelper</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation" class="description">
  
<h1 id="label-%40+%23+%2A+PRESTISSIMO+%2A+%23+%40">@ # * PRESTISSIMO * # @</h1>

<p>Welcome to Prestissimo&#39;s source code! Useful and/or relevant
information about Prestissimo can be found below (btw this file is the file
<a href="README_FOR_APP.html">README_FOR_APP</a> in the doc/ directory). If
you think of more things to add, please do feel free to add them.</p>

<h2 id="label-Table+of+Contents">Table of Contents</h2>
<hr style="height: 10px">

<h4 id="label-1.+New+to+Ruby+on+Rails%3F">1. New to Ruby on Rails?</h4>

<h4 id="label-2.+New+to+SVN%3F">2. New to SVN?</h4>

<h4 id="label-3.+Connecting+to+Prestissimo%2Frails+server">3. Connecting to Prestissimo/rails server</h4>

<h4 id="label-4.+How+many+servers+is+Prestissimo+on+anyways%3F">4. How many servers is Prestissimo on anyways?</h4>

<h4 id="label-5.+How+do+I+figure+out+what+the+heck+is+going+on+here%3F%3F">5. How do I figure out what the heck is going on here??</h4>

<h4 id="label-6.+Procedure+for+making+changes+to+the+website">6. Procedure for making changes to the website</h4>

<h4 id="label-7.+The+Database">7. The Database</h4>

<h3 id="label-1.+New+to+Ruby+on+Rails%3F">1. New to Ruby on Rails?</h3>
<hr style="height: 10px">

<p>If you have no idea what any of these Prestissimo files do/mean, you are
probably new to rails. You should do this tutorial. THE WHOLE THING.
Don&#39;t get lazy half way through and stop doing it because you will
still be lost. I MEAN IT.</p>

<p><a
href="http://ruby.railstutorial.org/ruby-on-rails-tutorial-book">ruby.railstutorial.org/ruby-on-rails-tutorial-book</a></p>

<p>It is quite comprehensive and will teach you (most) everything you will
need to know to work on Prestissimo. It doesn&#39;t go much into javascript
so you might need to do some more research on that if need be.</p>

<p>You will need to have at least a cursory understanding of Ruby–I recommend
Why&#39;s Poignant Guide to Ruby, at <a
href="http://mislav.uniqpath.com/poignant-guide/.">mislav.uniqpath.com/poignant-guide/.</a>
It&#39;s a little verbose, but it&#39;s a fun read. Just doing the first
couple chapters will give you a good enough idea of things.</p>

<p>You will need to know some html, css, and javascript/jquery. Good tutorials
for all of these can be found on <a
href="http://www.w3schools.com/.">www.w3schools.com/.</a> If you
haven&#39;t done any web development in the past, I suggest doing these
tutorials as well. They&#39;re pretty short and really helpful. A more
complete HTML, JS, and CSS reference can be found at the Mozilla Developer
Network, <a
href="https://developer.mozilla.org/en-US/">developer.mozilla.org/en-US/</a>,
and a complete technical book on modern Javascript can be found at <a
href="http://eloquentjavascript.net/contents.html">eloquentjavascript.net/contents.html</a>,
though this goes into much deeper detail than is perhaps neeed. Finally,
Prestissimo makes heavy use of the jQuery Javascript library, whose
extensive documentation can be found at <a
href="http://api.jquery.com/.">api.jquery.com/.</a></p>

<h3 id="label-2.+New+to+SVN%3F">2. New to SVN?</h3>
<hr style="height: 10px">

<p>Subversion (SVN) is the version control system that Prestissimo uses. If
you are new to SVN but not new to version control, it&#39;s not too
different from git, although some of the commands are different
syntactically, and branching is kind of weird.</p>

<p>If you are new to version control, you should read up on it. The rails
tutorial above uses git, and is a good example of how version control
should be used (although Prestissimo uses significantly fewer branches).
Find some short svn tutorials and read the wikipedia page for source
control.</p>

<p>Just keep in mind that whenever you make changes to Prestissimo, you&#39;ll
want to commit them. Update first, make changes, then commit. Commit early,
commit often. AND WRITE GOOD COMMIT MESSAGES.</p>

<p>More logistics:</p>
<ul><li>
<p><strong>*OLD SKIP*</strong> The SVN server is located at: <a
href="https://occs.cs.oberlin.edu/svn/prestissimo/prestissimo">occs.cs.oberlin.edu/svn/prestissimo/prestissimo</a></p>
</li><li>
<p><strong>*OLD SKIP*</strong> To check out a copy you can just type</p>

<pre>$ svn co https://occs.cs.oberlin.edu/svn/prestissimo/prestissimo</pre>
</li><li>
<p>The SVN URL is (since 2014):
svn+ssh://occs.cs.oberlin.edu/usr/users/noquota/prestissimo/svnrepo/prestissimo</p>
</li><li>
<p>To check out a copy you can just type</p>

<pre>$ svn co svn+ssh://occs.cs.oberlin.edu/usr/users/noquota/prestissimo/svnrepo/prestissimo</pre>
</li><li>
<p>You can run this to get more information</p>

<pre>$ svn info</pre>
</li><li>
<p>To deal with multiple users working in one directory (e.g., apache) preface
the command with a setting for <strong>SVN_SSH</strong> using your username</p>

<pre>$ SVN_SSH=&quot;ssh -l kuperman&quot; svn diff</pre>
</li></ul>

<p>SVN can be very frustrating sometimes (it often spits out very cryptic
messages and doesn&#39;t do what you want it to do), but have patience and
stick with it.</p>

<p>SVN has an extremely useful feature called <strong>diff</strong> that tells
you the differences between revisions. diff&#39;s default behavior is to
simply print out which chunks of code were altered between revisions, but
with large amounts of alterations, this can be a bit of a pain. A better
way to utilize this function is to view the differences with vim, a
command-line text editor. Follow these instructions to set up vimdiff: <a
href="http://blog.tplus1.com/blog/2007/08/29/how-to-use-vimdiff-as-the-subversion-diff-tool/.">blog.tplus1.com/blog/2007/08/29/how-to-use-vimdiff-as-the-subversion-diff-tool/.</a>
Then, to view differences, simply type  <code>svn diff -r 1112:1113</code>
replacing the revision numbers with whatever revisions you would like to
see. Lines that are changed will be highlighted in pretty colors (!),
making it easy to see where changes occurred.</p>

<p>If you have any questions, ask Ben Kuperman–he knows everything about SVN.</p>

<h3 id="label-3.+How+many+servers+is+Prestissimo+on+anyways%3F">3. How many servers is Prestissimo on anyways?</h3>
<hr style="height: 10px">

<p>Prestissimo lives in three locations:</p>
<ul><li>
<p>oprestissimo.com</p>
</li><li>
<p>oprestissimo.info</p>
</li><li>
<p>Your Home Directory (on oprestissimo.info)</p>
</li></ul>

<p><strong>oprestissimo.com</strong> is the production server. The files for
the real Prestissimo, the files that are running the whole shebang, are
located in: /srv/httpd/htdocs/prestissimo DON&#39;T TOUCH THEM. EVER. When
you need to make changes to the production website, there is a script that
will do everything without any human intervention. Read more about this in
section 6, <em>Procedure for making changes to the website</em>.</p>

<p><strong>oprestissimo.info</strong> is the development server. Most of the
time you will be logged into this server. This is also a public website,
but no one knows about it (<a
href="https://oprestissimo.info">oprestissimo.info</a>).  You should be
testing any changes you make with the oprestissimo.info server.  A copy of
prestissimo is also located on this server at:
/srv/httpd/htdocs/prestissimo</p>

<p><strong>Your Home Directory (on oprestissimo.info)</strong>: there should
be a copy of prestissimo in your home directory. If there isn&#39;t, you
can check one out (see above section). ALL THE CHANGES YOU EVER MAKE TO THE
WEBSITE WILL HAPPEN HERE. There are scipts that will automatically push
your changes to the development server and later the production server.</p>

<h3 id="label-4.+Connecting+to+Prestissimo%2Frails+server">4. Connecting to Prestissimo/rails server</h3>
<hr style="height: 10px">

<p>This part can be a bit confusing at first because of Oberlin&#39;s
firewalls, but bear with me. First of all, you can only access either
Prestissimo server through occs, so you will always first need to ssh to
occs, then Prestissimo.</p>

<p>If you have been reading up on Ruby on Rails, you know about <code>$ rails
server</code>. This is what you&#39;ll be using to view your changes in
your home directory version of prestissimo as you are making them.</p>

<p>You&#39;ll need to specify a port number when you start up rails server.
You can type <code>$ rails s -p &lt;port #&gt;</code>.</p>

<p>Some things to keep in mind with port numbers:</p>
<ul><li>
<p>you might have to try a couple different ports before you get a free one</p>
</li><li>
<p>Oberlin blocks ports that aren&#39;t between 3000-3100, so use something
like 3005</p>
</li></ul>

<p><strong>Viewing changes with rails server from within the CS lab</strong>:</p>
<ul><li>
<p>To see your rails server, navigate to
<code>http://oprestissimo.info:3005</code> (note that you DO NOT connect
with https. 3005 is just a placeholder port, you&#39;ll want to navigate to
the port that you specified with rails server -p &lt;port&gt;).</p>
</li></ul>

<p><strong>Connecting from outside the cs lab</strong>:</p>
<ul><li>
<p>If you want to work on Prestissimo remotely, you have to set up port
forwarding because outside of the cs lab, ports 3000-3100 are blocked. Port
forwarding is simple though, just follow these steps/enter these commands:</p>

<pre>$ ssh -L 3012:oprestissimo.info:3005 username@occs.cs.oberlin.edu</pre>

<p>Leave this session open in its own window.</p>
</li><li>
<p>Now, from a different terminal window, ssh again to occs and then
oprestissimo.info</p>

<pre>$ rails server -p 3005</pre>
</li><li>
<p>To view your site, you can navigate to <a
href="http://localhost:3012">localhost:3012</a></p>
</li></ul>

<p>Pretty cool, huh?</p>

<h3 id="label-5.+How+do+I+figure+out+what+the+heck+is+going+on+here%3F%3F">5. How do I figure out what the heck is going on here??</h3>
<hr style="height: 10px">

<p>The answer is simple: DOCUMENTATION.</p>

<p>Documentation is a very important part of any large piece of software. VERY
IMPORTANT. As you are learning how Prestissimo works, refer to its
documentation to gain a better understanding. As you add new things, add
new documentation. This mostly amounts to being careful about commenting
your code.</p>
<ol style="list-style-type: lower-alpha"><li>
<p>Where is Prestissimo&#39;s documentation? To find Prestissimo&#39;s
documentation, you can navigate to oprestissimo.info/app/index.html. This
takes you to the pretty browser based interface for exploring
Prestissimo&#39;s soure code. You should find lots of useful information
about all the controllers, models, helpers and libraries.</p>
</li><li>
<p>When should I write more documentation? If you add any new controllers,
models, or helpers or add new methods to an existing
controller/model/helper, you should write a sentence or two about what it
does, what parameters it takes in, what it returns, where is the method
being called, what views correspond to which controllers, etc. You can
write this directly in the code, above the
method/controller/helper/whatever.</p>
</li><li>
<p>How do I write more documentation? The documentation is all written using
rdoc style comments. Here is a short guide to writing the documentation: <a
href="http://rdoc.rubyforge.org/RDoc/Markup.html">rdoc.rubyforge.org/RDoc/Markup.html</a>
Think of it as javadocs.</p>

<p>To recompile the documentation, you simply type: <code>$ rake
doc:app</code></p>

<p>This reparses all of the docs and rebuilds the nice html pages in 
oprestissimo.info/app/index.html. The html pages are all in doc/app/</p>

<p>Recompile your docs often and make sure they look the way they should look–
rdoc sometimes doesn&#39;t do what you want it to do.</p>
</li></ol>

<p><strong>NOTE</strong>: You might have noticed that the html documentation
files are not under version control. Don&#39;t put then under version
control, since the whole directory gets deleted and recreated when you
recompile, and, as a result, SVN freaks out. When you are pushing your
changes to the dev and then production servers, the scripts will
automatically recompile the documentation.</p>

<h3 id="label-6.+Procedure+for+making+changes+to+the+website">6. Procedure for making changes to the website</h3>
<hr style="height: 10px">

<p>Okay, so you&#39;ve made some changes in your home directory Prestissimo
and you think they&#39;re ready to get pushed up to the production site.
Follow these steps to proceed:</p>
<ol><li>
<p><strong>DOCUMENT THE CHANGES THAT YOU HAVE MADE</strong>. Read more about
this in the previous section.</p>
</li><li>
<p>Don&#39;t forget to update the help pages with information about your
changes!!</p>
</li><li>
<p>Make sure you have committed all of your changes to the SVN repository.
Make sure SVN doesn&#39;t think you&#39;ve modified any of the database
files (especially courses.txt), only ruby on rails files. If it is
necessary to modify the database files (files contained in db/), be very
very careful and make sure you fully understand all of the scripts that
update the database.</p>
</li><li>
<p>In your home directory version of prestissimo, run  <code> $ sudo
./scripts/fixit </code> (If you don&#39;t have sudo permissions, you should
get Ben or someone else to give you sudo permission.) You can read the
script to see what it does, but basically it does an svn update of the
files in the main oprestissimo.info website.</p>
</li><li>
<p>Check to make sure your changes are working well on oprestissimo.info. Once
you are happy with the way oprestissimo.info is working, and you&#39;ve
decided that it&#39;s time to update the production server, you can proceed
to the next step.</p>
</li><li>
<p>ssh to the oprestissimo.com server. Your login should be the same as the
.info server</p>
</li><li>
<p>back up the database by cd&#39;ing into db and running  <code> $ sudo
./dump_db </code></p>
</li><li>
<p>sudo to the apache user:  <code> $ sudo -s -u apache </code></p>
</li><li>
<p>open up the file scripts/comfixit</p>
</li><li>
<p>change REVNUM to be the svn revision number of the version you are pushing.
This will probably just be the most recent version if you are updating, but
make note of what the version number was before you changed it in case you
have to rollback to a previous working version of the website.</p>
</li><li>
<p>If you need any gems to be updated you will also need to uncomment the
section  of comfixit that runs “bundle update” and, the first time you do
this, you should talk to professor kuperman about giving the apache user
privileges to use sudo without a password. He&#39;ll show you how to do so
in the future. When you&#39;re done, don&#39;t forget to recomment the
section!</p>
</li><li>
<p>You are now ready to run  <code> $ ./comfixit </code> After running
./comfixit, the oprestissimo.com website should have your changes on it. 
If things go awry, there are READMEs that will tell you how to roll back
the database in the doc directory, and you should also change the REVNUM in
comfixit to the one it was before and rerun comfixit.</p>
</li></ol>

<h3 id="label-7.+The+Database">7. The Database</h3>
<hr style="height: 10px">
<ol style="list-style-type: lower-alpha"><li>
<p><em>About the database</em></p>

<p>The database, as you can probably guess, holds information about all the
courses, users, carts, comments, and much more. There are various READMEs
in the doc/ directory that will explain more about the structure of the
database and how to update or  rollback the database.</p>
</li><li>
<p><em>Examining the database by hand</em></p>

<p>The database is a MySql database. If you need to log in to the database,
you can do so by typing:</p>

<pre>$ sudo mysql -u busystudent -p</pre>

<p>It will then prompt you for a password. If you need the password, ask Ben
Kuperman. The username is busystudent.</p>

<p>I would recommend accessing the database through rails console, however.
It&#39;s like directly accessing the database, but instead of doing it with
sql statements, you can use Ruby on Rails code.</p>
</li><li>
<p><em>Updating the courses in the database</em></p>

<p>The courses in the database get updated with the scripts/data_pull script.
Basically, we get a file from CIT, which goes into /home/datadump.
data_pull checks the time stamp on this file to see if we have received a
new one, and if so, it creates a file called courses.txt in the db
directory (btw, don&#39;t ever manually edit this file, it could wreak
havoc on the database). That file then gets parsed and fed into the
database with the rake task update_courses (located in
./lib/tasks/update_courses.rake). To gain a better understanding of what
happens, read through the scripts–the process is a little more involved
than what I just described.</p>
</li><li>
<p><em>Backing up the database </em></p>

<p>There are helpful READMEs in the /doc directory that explain more about the
database.</p>
</li><li>
<p><em>Who should we contact in CIT if we have problems?</em></p>

<p>As of now, our contact with CIT is Joe Barrile, who is the person who
actually  generates the file. Whenever a course catalog for a new semester
is published,  someone needs to contact Joe Barrile and have him start
sending files for the  new semester.</p>
</li><li>
<p><em>How do courses get updated between semesters?</em></p>

<p>Someone contacts Joe Barrile and reminds him to send us a file for the new
semester. The scripts that parse the file will be able to automatically
tell that it is for a new semester and will create new courses for all of
the courses in the new semester. It will update the value for
&#39;current_semester&#39; and add a new option on the front page for
semester. Basically, the whole process is entirely automated, as long as
the file for the new semester is in EXACTLY the same format as the file for
the old semester.</p>
</li><li>
<p><em>How do I set an admin?</em></p>

<p>Admins can be set by other admins on the website under Account/Admin/Edit
Global Settings, or by changing the user&#39;s admin column in the database
to 1.</p>

<pre>$  update users set admin=1 where email=&quot;flast@oberlin.edu&quot;</pre>
</li></ol>

</div>



<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.2.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

